<!DOCTYPE html>
<html>
<head>
  <title>CRM Dashboard</title>
</head>
<body>

  <h2>Welcome to Dashboard</h2>
  <p id="userEmail"></p>
  <button onclick="logout()">Logout</button>

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script>
    const supabaseUrl = "https://xloicmlcuonlsqagcvkw.supabase.co";
    const supabaseKey = "sb_publishable_Qp5Bx1JFwQatbaurKFfTvw_zfYYUj_W";

    const { createClient } = supabase;
    const supabaseClient = createClient(supabaseUrl, supabaseKey);

    async function checkUser() {
      const { data: { user } } = await supabaseClient.auth.getUser();

      if (!user) {
        window.location.href = "index.html";
      } else {
        document.getElementById("userEmail").innerText =
          "Logged in as: " + user.email;
      }
    }

    async function logout() {
      await supabaseClient.auth.signOut();
      window.location.href = "index.html";
    }

    checkUser();
  </script>

</body>
</html>